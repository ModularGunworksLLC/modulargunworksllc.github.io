<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Shopping Cart Demo</title>
  <link rel="stylesheet" href="style.css">
  <!-- PayPal JavaScript SDK -->
  <script src="https://www.paypal.com/sdk/js?client-id=AYd1GcwFQbrNbYKm2nYjeGLYy4Cfdh7aH3AtrjrtJHFgSLbUJC_8CHo-DXmNZXJqjqFIEsmIe-e02OPA&currency=USD"></script>
</head>
<body>
  <!-- TOP HEADER BAR (LOGO + SEARCH + ACCOUNT LINKS) -->
  <header class="site-header">
    <div class="header-left">
      <a href="index.html" title="Return to Homepage">
        <img src="images/modular-gunworks-llc.png" alt="Modular Gunworks LLC Logo" class="logo site-logo" id="site-logo">
      </a>
    </div>
    <div class="header-center">
      <form class="search-form" action="/search">
        <input type="text" class="search-bar" name="q" placeholder="Search ammo, gear, or answers...">
        <button type="submit" class="search-button">
          <img src="images/search-icon.svg" alt="Search">
        </button>
      </form>
    </div>
    <div class="header-right">
      <a href="#">Account Login</a>
      <a href="#">Help Center</a>
      <a href="cart.html">View Cart</a>
      <button id="theme-toggle" class="theme-toggle-icon" aria-label="Toggle Theme">
        <span id="theme-icon">
          <!-- Default icon: Moon (light mode) -->
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none"
               stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
        </span>
      </button>
    </div>
  </header>

  <!-- CATEGORY NAVIGATION (STICKY) -->
  <nav class="category-nav">
    <a class="nav-link paused" href="#" tabindex="-1" title="Coming Soon">Ammunition</a>
    <!-- <a class="nav-link paused" href="#" tabindex="-1" title="Coming Soon">Guns</a> -->
    <a class="nav-link paused" href="#" tabindex="-1" title="Coming Soon">Magazines</a>
    <a class="nav-link paused" href="#" tabindex="-1" title="Coming Soon">Gun Parts</a>
    <a class="nav-link paused" href="#" tabindex="-1" title="Coming Soon">Gear</a>
    <a class="nav-link paused" href="#" tabindex="-1" title="Coming Soon">Optics & Sights</a>
    <a class="nav-link paused" href="#" tabindex="-1" title="Coming Soon">Reloading</a>
    <a class="nav-link paused" href="#" tabindex="-1" title="Coming Soon">Prep & Survival</a>
    <a class="nav-link paused" href="#" tabindex="-1" title="Coming Soon">Brands</a>
    <a class="nav-link paused" href="#" tabindex="-1" title="Coming Soon">ON SALE</a>
  </nav>
  <main>
    <section class="cart-section" style="max-width:480px;margin:40px auto;padding:32px 24px;background:#fff;border-radius:12px;box-shadow:0 4px 24px rgba(0,0,0,0.08);">
      <h2 style="margin:0 0 18px 0;font-size:1.4rem;">Your Shopping Cart</h2>
      <div id="cart-items-list" style="margin:0;"></div>
      <div id="cart-status" style="margin:24px 0 0 0;font-size:1.1rem;"></div>
      <button id="checkout-btn" style="margin-top:24px;display:none;background:#00b86b;color:#fff;padding:12px 32px;border:none;border-radius:6px;font-size:1.1rem;cursor:pointer;transition:background 0.2s;">Checkout</button>
      <!-- PayPal Checkout Button -->
      <div id="paypal-cart-button" style="margin-top:24px;"></div>
    </section>
  </main>
  <script>
    // Simple cart logic using localStorage
    const addToCartBtn = document.getElementById('add-to-cart-btn');
    const checkoutBtn = document.getElementById('checkout-btn');
    const cartStatus = document.getElementById('cart-status');
    
    function renderCartItems() {
      const cart = JSON.parse(localStorage.getItem('cart') || '[]');
      const cartList = document.getElementById('cart-items-list');
      const checkoutBtn = document.getElementById('checkout-btn');
      // Map SKUs to images
      const productImages = {
        'DEMO-001': 'images/thumbnails/BW0826BG_2.webp',
        'DEMO-002': 'images/thumbnails/BW1160BL.webp'
      };
      if (cart.length === 0) {
        cartList.innerHTML = `
          <div style="text-align:center;padding:32px 0;">
            <div style="font-size:2.5rem;">ðŸ›’</div>
            <div style="font-size:1.25rem;font-weight:600;margin:12px 0 8px 0;">Your cart is empty</div>
            <div style="color:#888;margin-bottom:18px;">Looks like you havenâ€™t added anything yet.</div>
            <a href="index.html" style="display:inline-block;background:#0033aa;color:#fff;padding:12px 32px;border-radius:6px;font-size:1.08rem;text-decoration:none;font-weight:600;transition:background 0.2s;">Continue Shopping</a>
          </div>
        `;
        checkoutBtn.style.display = 'none';
        document.getElementById('paypal-cart-button').innerHTML = '';
        return;
      }
      cartList.innerHTML = '<h3 style="margin-bottom:10px;">Cart Items</h3>' + cart.map((item, idx) => {
        const imgSrc = productImages[item.sku] || '';
        return `
        <div style="display:flex;align-items:center;justify-content:space-between;background:#f7f7fa;padding:12px 16px;margin-bottom:10px;border-radius:7px;">
          <div style="display:flex;align-items:center;gap:14px;">
            <img src="${imgSrc}" alt="${item.name}" style="width:48px;height:48px;object-fit:cover;border-radius:8px;background:#f5f7fa;">
            <div>
              <strong>${item.name}</strong><br>
              <span style='color:#888;font-size:0.95rem;'>SKU: ${item.sku}</span><br>
              <span style='font-size:1.05rem;'>$${item.price.toFixed(2)}</span>
            </div>
          </div>
          <div style="display:flex;align-items:center;gap:8px;">
            <button onclick="updateCartQty('${item.sku}', -1)" style="background:#eee;color:#333;border:none;padding:4px 10px;border-radius:4px;font-size:1.1rem;cursor:pointer;">-</button>
            <span style="min-width:24px;display:inline-block;text-align:center;">${item.qty || 1}</span>
            <button onclick="updateCartQty('${item.sku}', 1)" style="background:#eee;color:#333;border:none;padding:4px 10px;border-radius:4px;font-size:1.1rem;cursor:pointer;">+</button>
            <button onclick="removeCartItem('${item.sku}')" style="background:#e74c3c;color:#fff;border:none;padding:7px 12px;border-radius:5px;font-size:0.98rem;cursor:pointer;margin-left:8px;">Remove</button>
          </div>
        </div>
        `;
      }).join('');
        // Quantity adjustment
        window.updateCartQty = function(sku, delta) {
          let cart = JSON.parse(localStorage.getItem('cart') || '[]');
          cart = cart.map(item => {
            if (item.sku === sku) {
              let newQty = (item.qty || 1) + delta;
              if (newQty < 1) newQty = 1;
              return { ...item, qty: newQty };
            }
            return item;
          });
          localStorage.setItem('cart', JSON.stringify(cart));
          updateCartStatus();
        };
    }

    function updateCartStatus() {
      const cart = JSON.parse(localStorage.getItem('cart') || '[]');
      renderCartItems();
      if (cart.length > 0) {
        cartStatus.innerHTML = `<span style='color:#00b86b;font-weight:600;'>âœ” Item added to cart!</span> <br>Items in cart: <strong>${cart.length}</strong>`;
        checkoutBtn.style.display = 'inline-block';
      } else {
        cartStatus.innerHTML = '<span style="color:#888;">Cart is empty.</span>';
        checkoutBtn.style.display = 'none';
      }
    }

    // Remove item by SKU
    window.removeCartItem = function(sku) {
      let cart = JSON.parse(localStorage.getItem('cart') || '[]');
      cart = cart.filter(item => item.sku !== sku);
      localStorage.setItem('cart', JSON.stringify(cart));
      updateCartStatus();
    };

    if (addToCartBtn) {
      addToCartBtn.onclick = function() {
        const cart = JSON.parse(localStorage.getItem('cart') || '[]');
        cart.push({ sku: 'DEMO-001', name: 'Demo Product', price: 99.99, qty: 1 });
        localStorage.setItem('cart', JSON.stringify(cart));
        updateCartStatus();
      };
    }
    if (checkoutBtn) {
      checkoutBtn.onclick = function() {
        window.location.href = 'checkout.html';
      };
    }
    // Initialize cart display on page load
    renderCartItems();

    // Render PayPal Button for Cart
    function getCartTotal() {
      const cart = JSON.parse(localStorage.getItem('cart') || '[]');
      return cart.reduce((sum, item) => sum + (item.price * (item.qty || 1)), 0).toFixed(2);
    }

    paypal.Buttons({
      createOrder: function(data, actions) {
        return actions.order.create({
          purchase_units: [{
            amount: { value: getCartTotal() },
            description: 'Modular Gunworks LLC Cart Purchase'
          }]
        });
      },
      onApprove: function(data, actions) {
        return actions.order.capture().then(function(details) {
          alert('Transaction completed by ' + details.payer.name.given_name);
          // Optionally clear cart after payment
          localStorage.removeItem('cart');
          renderCartItems();
        });
      },
      onError: function(err) {
        alert('PayPal Checkout Error: ' + err);
      }
    }).render('#paypal-cart-button');
  </script>
</body>
</html>