<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Your Cart | Modular Gunworks LLC</title>
  <link rel="stylesheet" href="../style.css">
  <link rel="icon" type="image/png" href="../favicon.png">
</head>
<body>
  <header class="site-header">
    <div class="header-left">
      <a href="../index.html" title="Return to Homepage">
        <img src="../images/modular-gunworks-llc.png" alt="Modular Gunworks LLC Logo" class="logo site-logo" id="site-logo">
      </a>
    </div>
    <div class="header-center">
      <form class="search-form" action="/search">
        <input type="text" class="search-bar" name="q" placeholder="Search ammo, gear, or answers...">
        <button type="submit" class="search-button">
          <img src="../images/search-icon.svg" alt="Search">
        </button>
      </form>
    </div>
    <div class="header-right">
      <a href="#">Account Login</a>
      <a href="#">Help Center</a>
      <a href="cart.html">View Cart</a>
      <button id="theme-toggle" class="theme-toggle-icon" aria-label="Toggle Theme">
        <span id="theme-icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
        </span>
      </button>
    </div>
  </header>
  <main class="cart-main" style="max-width:600px;margin:2rem auto;">
    <h2>Your Shopping Cart</h2>
    <div id="cart-items"></div>
    <div id="cart-total" style="font-size:1.2em;margin:1em 0;"></div>
    <div id="paypal-button-container"></div>
  </main>
  <footer class="site-footer">
    <div class="footer-bottom">
      <p>Â© 2025 Modular Gunworks LLC. All rights reserved.</p>
      <p><a href="mailto:modulargunworks@gmail.com">modulargunworks@gmail.com</a></p>
    </div>
  </footer>
  <script src="https://www.paypal.com/sdk/js?client-id=AYd1GcwFQbrNbYKm2nYjeGLYy4Cfdh7aH3AtrjrtJHFgSLbUJC_8CHo-DXmNZXJqjqFIEsmIe-e02OPA&currency=USD"></script>
  <script>
    // Simple cart using localStorage
    function getCart() {
      return JSON.parse(localStorage.getItem('cart') || '[]');
    }
    function setCart(cart) {
      localStorage.setItem('cart', JSON.stringify(cart));
    }
    function renderCart() {
      const cart = getCart();
      const itemsDiv = document.getElementById('cart-items');
      if (cart.length === 0) {
        itemsDiv.innerHTML = '<p>Your cart is empty.</p>';
        document.getElementById('cart-total').textContent = '';
        return 0;
      }
      let total = 0;
      itemsDiv.innerHTML = '<ul style="list-style:none;padding:0;">' + cart.map((item, idx) => {
        total += item.price * item.qty;
        return `<li style="margin-bottom:1em;border-bottom:1px solid #eee;padding-bottom:1em;">
          <strong>${item.name}</strong> <br>
          $${item.price.toFixed(2)} x ${item.qty} = $${(item.price * item.qty).toFixed(2)}
          <button onclick="removeItem(${idx})" style="margin-left:1em;">Remove</button>
        </li>`;
      }).join('') + '</ul>';
      document.getElementById('cart-total').textContent = 'Total: $' + total.toFixed(2);
      return total;
    }
    function removeItem(idx) {
      const cart = getCart();
      cart.splice(idx, 1);
      setCart(cart);
      renderCart();
      renderPayPal();
    }
    function renderPayPal() {
      const total = renderCart();
      document.getElementById('paypal-button-container').innerHTML = '';
      if (total > 0) {
        paypal.Buttons({
          createOrder: function(data, actions) {
            return actions.order.create({
              purchase_units: [{ amount: { value: total.toFixed(2) } }]
            });
          },
          onApprove: function(data, actions) {
            return actions.order.capture().then(function(details) {
              alert('Transaction completed by ' + details.payer.name.given_name);
              setCart([]);
              renderCart();
              renderPayPal();
            });
          }
        }).render('#paypal-button-container');
      }
    }
    window.onload = function() {
      renderCart();
      renderPayPal();
    };
  </script>
  <script src="../scripts/theme-toggle.js"></script>
</body>
</html>
